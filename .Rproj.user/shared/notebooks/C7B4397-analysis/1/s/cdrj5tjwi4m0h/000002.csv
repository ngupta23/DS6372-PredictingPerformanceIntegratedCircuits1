"0","plot.diagnostics <-  function(model, train) {"
"0","  plot(model)"
"0","  "
"0","  residuals = resid(model) # Plotted above in plot(lm.out)"
"0","  r.standard = rstandard(model)"
"0","  r.student = rstudent(model)"
"0","  plot(predict(model,train),r.student,"
"0","      ylab=""Student Residuals"", xlab=""Predicted Values"", "
"0","      main=""Student Residual Plot"") "
"0","  abline(0, 0)"
"0","  "
"0","  plot(predict(model, train),r.standard,"
"0","      ylab=""Standard Residuals"", xlab=""Predicted Values"", "
"0","      main=""Standard Residual Plot"") "
"0","  abline(0, 0)"
"0","  abline(2, 0)"
"0","  abline(-2, 0)"
"0","  "
"0","  # Histogram"
"0","  hist(r.student, freq=FALSE, main=""Distribution of Studentized Residuals"", "
"0","  xlab=""Studentized Residuals"", ylab=""Density"", ylim=c(0,0.5))"
"0","  # Create range of x-values for normal curve"
"0","  xfit <- seq(min(r.student)-1, max(r.student)+1, length=40)"
"0","  # Generate values from the normal distribution at the specified values"
"0","  yfit <- (dnorm(xfit))"
"0","  # Add the normal curve"
"0","  lines(xfit, yfit, ylim=c(0,0.5))"
"0","  "
"0","  "
"0","  # http://www.stat.columbia.edu/~martin/W2024/R7.pdf"
"0","  # Influential plots"
"0","  inf.meas = influence.measures(model)"
"0","  print (summary(inf.meas))"
"0","  "
"0","  # Leverage plot"
"0","  # Influential plots"
"0","  lev = hat(model.matrix(model))"
"0","  plot(lev, ylab = 'Leverage - check')"
"0","  "
"0","  # Cook's Distance"
"0","  cd = cooks.distance(model)"
"0","  plot(cd,ylab=""Cooks distances"")"
"0","  abline(4/nrow(train),0)"
"0","  abline(1,0)"
"0","  print (paste(""Number of data points that have Cook's D > 4/n: "", length(cd[cd > 4/nrow(train)]), sep = """")) "
"0","  print (paste(""Number of data points that have Cook's D > 1: "", length(cd[cd > 1]), sep = """")) "
"0","  return(cd)"
"0","}"
